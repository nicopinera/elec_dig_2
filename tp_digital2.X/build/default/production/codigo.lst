MPASM 5.87                        CODIGO.ASM   6-15-2025  20:57:51         PAGE  1


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00001     LIST        p=16f887
                      00002     #INCLUDE    <p16f887.inc>
                      00001         LIST
                      00002 
                      00003 ;==========================================================================
                      00004 ; Build date : Jan 06 2020
                      00005 ;  MPASM PIC16F887 processor include
                      00006 ; 
                      00007 ;  (c) Copyright 1999-2020 Microchip Technology, All rights reserved
                      00008 ;==========================================================================
                      00009 
                      00810         LIST
                      00003     
                      00004 ;-------------------------------
                      00005 ; Variables externas
                      00006 ;-------------------------------
                      00007 ; Nos indica si estamos esperando un numero y si se ingreso el primer digito
                      00008 ; B0 = 1 = Esperando - B0 = 0 = No Esperando
                      00009 ; B1 = 0 = No se ingreso el primer digito - B1 = 1 = Se ingreso el primer digito
  00000020            00010 INGRESAR    EQU 0X20
                      00011 
                      00012 ; Temperatura de Referencia
  00000021            00013 TEMPREF     EQU 0X21
                      00014 
                      00015 ; Indice de tecla pulsada (0-15)
  00000022            00016 INDICE      EQU 0X22
                      00017 
                      00018 ; En que columna estoy (1-4)
  00000023            00019 COL         EQU 0X23
                      00020 
                      00021 ; Mascara de columna
  00000024            00022 COLMASK     EQU 0X24    
                      00023 
                      00024 ; Banderas
                      00025 ; B0: Bandera de 1 segundo - Si =1 comienza la conversion en ADC - Si =0 no compienza la conversion - Ba
                            ndera activada por TMR1 cada 1 segundo
                      00026 ;FLAG       EQU 0X31
                      00027             
                      00028             
                      00029 ; Displays
  00000025            00030 DIGITO_0    EQU 0X25        ; Unidad
  00000026            00031 DIGITO_1    EQU 0X26        ; Decena
  00000027            00032 DISPLAY_FLAG    EQU     0X27        ; Alterna entre display 0 y 1
                      00033 
                      00034 ; Contador delay
  00000028            00035 CONT0 EQU 0X28       
  00000029            00036 CONT1 EQU 0X29 
  0000002A            00037 DIG1 EQU 0X2A        ; Primer dígito temporal
  0000002B            00038 WREG_TEMP EQU 0X2B   ; Variable temporal para cálculos
  0000002C            00039 WREG_TEMP2 EQU 0X2C  ; Variable temporal para cálulos
  0000002D            00040 FLAG_1SEG EQU 0X2D   ; Bandera activada por TMR1 cada 1 segundo
  0000002E            00041 FLAG_ADC_OK EQU 0X2E ; Bandera que indica que el ADC terminó
  0000002F            00042 FLAG_TX EQU 0X2F     ; Bandera para indicar que hay que transmitir
MPASM 5.87                        CODIGO.ASM   6-15-2025  20:57:51         PAGE  2


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  00000030            00043 TEMPACTUAL EQU 0X30  ;Temperatura actual
                      00044 
                      00045 ; Para guardar contexto
  00000070            00046 WTEMP   EQU 0X70
  00000071            00047 STATUST EQU 0X71
                      00048 ; --------------------------------------------
                      00049     ORG     0X0
0000   2???           00050     GOTO    MAIN    ; El programa comienza en la direccion 0 y salta a la rutina principal MAIN.
                      00051 ; --------------------------------------------
                      00052     ORG     0X04
0004   2???           00053     GOTO    ISR     ; Si ocurre una interrupcion, el programa salta a la rutina ISR.
                      00054 ; --------------------------------------------
                      00055     ORG 0X05
0005                  00056 MAIN:
0005   01A0           00057     CLRF        INGRESAR    ; -- Limpieza de Banderas
0006   01A1           00058     CLRF        TEMPREF
0007   01AD           00059     CLRF        FLAG_1SEG
0008   01AE           00060     CLRF        FLAG_ADC_OK
0009   01AF           00061     CLRF        FLAG_TX
000A   01A5           00062     CLRF        DIGITO_0        
000B   01A6           00063     CLRF        DIGITO_1     
000C   01A7           00064     CLRF        DISPLAY_FLAG
                      00065 
000D   1683 1303      00066     BANKSEL     TRISD       ; -- Configuracion de Puertos
000F   30F0           00067     MOVLW       B'11110000' ; RD7-RD4 Entradas (filas), RD3-RD0 Filas (columnas)
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0010   0088           00068     MOVWF       TRISD
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0011   0187           00069     CLRF        TRISC       ; Display segmentos como salida
0012   3001           00070     MOVLW       B'00000001' ; Configura el puerto B: RBO para el pulsador y RB1 -RB2 los habilitadores d
                            el display.
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0013   0086           00071     MOVWF       TRISB
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0014   1409           00072     BSF         TRISE,RE0   ; Configura el puerto E: RE0 como entrada analogica para el sensor y RE1 com
                            o salida para el LED.
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0015   1089           00073     BCF         TRISE,RE1   
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0016   0185           00074     CLRF        TRISA       ; Configura el puerto A como salida para enviar datos al display.
0017   1283 1303      00075     BANKSEL     PORTA
0019   0188           00076     CLRF        PORTD        ; Asegura que columnas inician en 0
001A   0186           00077     CLRF        PORTB
001B   0189           00078     CLRF        PORTE
001C   0185           00079     CLRF        PORTA
001D   1683 1703      00080     BANKSEL     ANSELH      ; Configura RB0 como entrada digital (no analógica).
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
001F   1209           00081     BCF         ANSELH,ANS12
                      00082     
0020   1683 1303      00083     BANKSEL     OSCCON      ; -- Configura el oscilador interno del microcontrolador a 2 MHz.
0022   3058           00084     MOVLW       B'01011000'
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0023   008F           00085     MOVWF       OSCCON      
MPASM 5.87                        CODIGO.ASM   6-15-2025  20:57:51         PAGE  3


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00086     
0024   1283 1303      00087     BANKSEL     ADCON0      ; -- Configuracion del ADC
0026   3015           00088     MOVLW       B'00010101' ; Canal AN5 (RE0), ADC habilitado pero no convirtiendo 
0027   009F           00089     MOVWF       ADCON0      ; Frecuencia = Fosc/2 = 1[MHz]
0028   019E           00090     CLRF        ADRESH      ; Limpio registro donde se guarda la conversion
0029   1683 1303      00091     BANKSEL     ADCON1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
002B   019F           00092     CLRF        ADCON1      ; Justificado a la izquierda, Vref = VDD-VSS
                      00093     
002C   1683 1303      00094     BANKSEL     TXSTA       ; -- Configuracion de la Tx
002E   3024           00095     MOVLW       B'00100100' ; TXEN=1, BRGH=1 (alta velocidad)
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
002F   0098           00096     MOVWF       TXSTA
0030   1283 1303      00097     BANKSEL     RCSTA
0032   3080           00098     MOVLW       B'10000000' ; SPEN=1 habilita transmisor
0033   0098           00099     MOVWF       RCSTA
0034   1683 1303      00100     BANKSEL     SPBRG
0036   300C           00101     MOVLW       .12         ; Baud Rate 9600 con Fosc = 2MHz (BRGH=1): SPBRG=12
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0037   0099           00102     MOVWF       SPBRG
                      00103     
0038   1283 1303      00104     BANKSEL     T1CON       ; -- Timer 1
003A   018E           00105     CLRF        TMR1L
003B   018F           00106     CLRF        TMR1H
003C   3030           00107     MOVLW       B'00110000'
003D   0090           00108     MOVWF       T1CON            ; Inicializa el temporizador TMR1 y lo configura.
                      00109     
003E   1283 1303      00110     BANKSEL     INTCON              ; -- Configuracion de Interrupciones y TMR0
0040   30F0           00111     MOVLW       B'11110000'     ; Habilito GIE - PEIE - T0IE- INTE y limpio bandera INTF
0041   008B           00112     MOVWF       INTCON 
0042   018C           00113     CLRF            PIR1                    ; Limpio banderas de ADC - Tx - TRM1iF
0043   1683 1303      00114     BANKSEL     OPTION_REG
0045   3097           00115     MOVLW           B'10010111'     ; Flanco de bajada para INT - Frecuencia interna para TMR0 - Prescal
                            er para TMR0 - 1:256
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0046   0081           00116     MOVWF           OPTION_REG  
0047   1683 1303      00117     BANKSEL         PIE1                
0049   3051           00118     MOVLW       B'01010001'     ; Habilito interrupciones por ADC - TX - TMR1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
004A   008C           00119     MOVWF       PIE1            
                      00120 
                      00121     ;Activo TMR1
004B   1283 1303      00122     BANKSEL     T1CON
004D   1410           00123     BSF         T1CON,0             
                      00124 ; --------------------------------------------
004E                  00125 MAIN_LOOP:                      ; -- Loop Principal
004E   1820           00126     BTFSC       INGRESAR,0          ; Si está esperando ingreso de número
004F   2???           00127     CALL        TECLADO             ; Llama a la rutina de teclado
0050   1820           00128     BTFSC       INGRESAR,0      ; Si sigue esperando ingreso, no hace nada más
0051   2???           00129     GOTO        MAIN_LOOP
                      00130 
0052   182D           00131     BTFSC           FLAG_1SEG, 0    ; Si pasó 1 segundo, inicio conversión ADC
0053   2???           00132     GOTO        INICIAR_ADC     ; Si no pasó 1 segundo, sigue
MPASM 5.87                        CODIGO.ASM   6-15-2025  20:57:51         PAGE  4


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00133 
0054   182E           00134     BTFSC       FLAG_ADC_OK, 0  ; Si el ADC finalizó, preparar para transmitir
0055   2???           00135     GOTO        PREPARAR_TX
                      00136 
0056   182F           00137     BTFSC       FLAG_TX, 0      ; Si hay que transmitir, enviar por UART
0057   2???           00138     GOTO        ENVIAR_UART
                      00139 
                      00140     ; Comparación de temperatura actual con la temperatura de referencia para prender el led
0058   0821           00141     MOVF        TEMPREF,W
0059   0230           00142     SUBWF       TEMPACTUAL,W
005A   1803           00143     BTFSC       STATUS,C            ; Si TEMPACTUAL >= TEMPREF
005B   1489           00144     BSF         PORTE,RE1           ; Enciende LED
                      00145     ; FALTA: Apagar el LED si TEMPACTUAL < TEMPREF
005C   1C03           00146     BTFSS       STATUS,C
005D   1089           00147     BCF         PORTE,RE1
005E   2???           00148     GOTO        MAIN_LOOP
                      00149 
005F                  00150 INICIAR_ADC:
005F   102D           00151     BCF             FLAG_1SEG, 0        
0060   1283 1303      00152     BANKSEL         ADCON0
0062   149F           00153     BSF             ADCON0, GO     ; Iniciar conversión del ADC
0063   141F           00154     BSF             ADCON0, ADON
0064   2???           00155     GOTO        MAIN_LOOP
                      00156 
0065                  00157 PREPARAR_TX:
0065   102E           00158     BCF         FLAG_ADC_OK, 0
0066   142F           00159     BSF         FLAG_TX, 0     ; Listo para enviar por UART
0067   2???           00160     GOTO        MAIN_LOOP
                      00161 
0068                  00162 ENVIAR_UART: ; Enviar TEMPACTUAL por UART como ASCII (2 dígitos)
0068   0830           00163     MOVF    TEMPACTUAL, W
0069   00AB           00164     MOVWF   WREG_TEMP
006A   300A           00165     MOVLW   .10
006B   00AC           00166     MOVWF   WREG_TEMP2
006C   01AA           00167     CLRF    DIG1
                      00168     
006D                  00169 DIV_LOOP:   ; Dividir por 10 para obtener decena
006D   082B           00170     MOVF    WREG_TEMP, W
006E   022C           00171     SUBWF   WREG_TEMP2, W
006F   1C03           00172     BTFSS   STATUS, C
0070   2???           00173     GOTO    ENVIAR_DIGITOS
0071   0FAA           00174     INCFSZ  DIG1, F
0072   02AB           00175     SUBWF   WREG_TEMP, F
0073   2???           00176     GOTO    DIV_LOOP
                      00177 
0074                  00178 ENVIAR_DIGITOS: ; Enviar decena
0074   082A           00179     MOVF    DIG1, W
0075   3E30           00180     ADDLW   '0'
0076   0099           00181     MOVWF   TXREG
0077                  00182 ESPERO_TX1:
0077   1E0C           00183     BTFSS   PIR1,TXIF
0078   2???           00184     GOTO    ESPERO_TX1
0079   082B           00185     MOVF    WREG_TEMP, W    ; Enviar unidad
MPASM 5.87                        CODIGO.ASM   6-15-2025  20:57:51         PAGE  5


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

007A   3E30           00186     ADDLW   '0'
007B   0099           00187     MOVWF   TXREG
007C                  00188 ESPERO_TX2:
007C   1E0C           00189     BTFSS   PIR1,TXIF
007D   2???           00190     GOTO    ESPERO_TX2
007E   300A           00191     MOVLW   0x0A    ; Agregar salto de línea (LF, 0x0A)
007F   0099           00192     MOVWF   TXREG
0080                  00193 ESPERO_TX3:
0080   1E0C           00194     BTFSS   PIR1,TXIF
0081   2???           00195     GOTO    ESPERO_TX3
0082   102F           00196     BCF     FLAG_TX, 0
0083   2???           00197     GOTO    MAIN_LOOP
                      00198 ; --------------------------------------------
0084                  00199 TECLADO:                    ; Subrutina de Teclado
0084   1283 1303      00200     BANKSEL     PORTD
0086   300E           00201     MOVLW       0x0E        ; RD3-RD1 en 1 (columnas), RD7-RD4 entradas (filas)
0087   0488           00202     IORWF       PORTD, F    ; Asegura columnas en 1
0088   0808           00203     MOVF        PORTD, W    ; Lee filas
0089   39F0           00204     ANDLW       0xF0        ; Enmascara filas
008A   1903           00205     BTFSC       STATUS, Z
008B   2???           00206     GOTO        TECLADO     ; No hay teclas presionadas
008C   2???           00207     CALL        RETARDO_20ms
008D   0808           00208     MOVF        PORTD, W
008E   39F0           00209     ANDLW       0xF0
008F   1903           00210     BTFSC       STATUS, Z
0090   2???           00211     GOTO        TECLADO     ; No hay teclas presionadas
0091   2???           00212     CALL        ESCANEAR_TECLAS
0092   0822           00213     MOVF        INDICE, W
0093   3C0B           00214     SUBLW       0x0B        ; Solo índices 0-11 válidos
0094   1C03           00215     BTFSS       STATUS, C
0095   0008           00216     RETURN                  ; No válido
0096   0822           00217     MOVF        INDICE, W
0097   2???           00218     CALL        TECLAS
0098   00AB           00219     MOVWF       WREG_TEMP
0099   082B           00220     MOVF        WREG_TEMP, W
009A   3AFF           00221     XORLW       0xFF
009B   1903           00222     BTFSC       STATUS, Z
009C   0008           00223     RETURN      ; Si es 0xFF, no hacer nada
009D   1CA0           00224     BTFSS       INGRESAR, 1
009E   2???           00225     GOTO        TECLADO_PRIMER_DIGITO
009F   2???           00226     CALL        TECLADO_SEGUNDO_DIGITO
00A0   0008           00227     RETURN
                      00228 
00A1                  00229 TECLADO_SEGUNDO_DIGITO:
00A1   082A           00230     MOVF    DIG1, W
00A2   00A1           00231     MOVWF   TEMPREF
00A3   082A           00232     MOVF    DIG1, W
00A4   0D2B           00233     RLF     WREG_TEMP, W
00A5   07A1           00234     ADDWF   TEMPREF, F
00A6   0821           00235     MOVF    TEMPREF, W
00A7   0D2B           00236     RLF     WREG_TEMP, W
00A8   07A1           00237     ADDWF   TEMPREF, F
00A9   082A           00238     MOVF    DIG1, W
MPASM 5.87                        CODIGO.ASM   6-15-2025  20:57:51         PAGE  6


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00AA   07A1           00239     ADDWF   TEMPREF, F
00AB   082B           00240     MOVF    WREG_TEMP, W
00AC   07A1           00241     ADDWF   TEMPREF, F
00AD   2???           00242     CALL    ACTUALIZAR_DISPLAY
00AE   1020           00243     BCF     INGRESAR, 0
00AF   10A0           00244     BCF     INGRESAR, 1
00B0   0008           00245     RETURN
                      00246 
00B1                  00247 TECLADO_PRIMER_DIGITO:
00B1   082B           00248     MOVF    WREG_TEMP, W
00B2   00AA           00249     MOVWF   DIG1
00B3   14A0           00250     BSF     INGRESAR, 1
00B4   2???           00251     GOTO    TECLADO
                      00252 
00B5                  00253 ESCANEAR_TECLAS:
00B5   01A3           00254     CLRF    COL
00B6   3002           00255     MOVLW   0x02            ; RD1 (columna 1)
00B7   00A4           00256     MOVWF   COLMASK
00B8                  00257 SCAN_COL_LOOP:
00B8   300E           00258     MOVLW   0x0E            ; RD3-RD1 en 1
00B9   0488           00259     IORWF   PORTD, F
00BA   0924           00260     COMF    COLMASK, W      ; Columna activa en 0
00BB   390E           00261     ANDLW   0x0E            ; Solo columnas
00BC   38F0           00262     IORLW   0xF0            ; Filas en 1
00BD   0088           00263     MOVWF   PORTD
00BE   0000           00264     NOP
00BF   0000           00265     NOP
00C0   0808           00266     MOVF    PORTD, W
00C1   39F0           00267     ANDLW   0xF0
00C2   3AF0           00268     XORLW   0xF0
00C3   1903           00269     BTFSC   STATUS, Z
00C4   2???           00270     GOTO    NEXT_COL
00C5   0808           00271     MOVF    PORTD, W
00C6   39F0           00272     ANDLW   0xF0
00C7   3AF0           00273     XORLW   0xF0
00C8   00AB           00274     MOVWF   WREG_TEMP
00C9   01A2           00275     CLRF    INDICE
00CA   3080           00276     MOVLW   0x80            ; RD7 (fila 1)
00CB   00AC           00277     MOVWF   WREG_TEMP2
00CC                  00278 SCAN_ROW_LOOP:
00CC   082B           00279     MOVF    WREG_TEMP, W
00CD   052C           00280     ANDWF   WREG_TEMP2, W
00CE   1D03           00281     BTFSS   STATUS, Z
00CF   2???           00282     GOTO    FOUND_ROW
00D0   0AA2           00283     INCF    INDICE, F
00D1   0CAC           00284     RRF     WREG_TEMP2, F   ; Siguiente fila (RD7->RD6->RD5->RD4)
00D2   082C           00285     MOVF    WREG_TEMP2, W
00D3   1903           00286     BTFSC   STATUS, Z
00D4   2???           00287     GOTO    NEXT_COL
00D5   2???           00288     GOTO    SCAN_ROW_LOOP
00D6                  00289 FOUND_ROW:
                      00290     ; INDICE = número de fila (0-3)
                      00291     ; Calcula índice físico: INDICE = fila*3 + (columna-1)
MPASM 5.87                        CODIGO.ASM   6-15-2025  20:57:51         PAGE  7


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00D6   0822           00292     MOVF    INDICE, W
00D7   00AC           00293     MOVWF   WREG_TEMP2
00D8   0DAC           00294     RLF     WREG_TEMP2, F   ; *2
00D9   0722           00295     ADDWF   INDICE, W       ; W = fila*3 + fila
00DA   0823           00296     MOVF    COL, W
00DB   072C           00297     ADDWF   WREG_TEMP2, W   ; W = fila*3 + columna
00DC   00A2           00298     MOVWF   INDICE
00DD   0008           00299     RETURN
00DE                  00300 NEXT_COL:
00DE   0AA3           00301     INCF    COL, F
00DF   3003           00302     MOVLW   0x03
00E0   0223           00303     SUBWF   COL, W
00E1   1D03           00304     BTFSS   STATUS, Z
00E2   0DA4           00305     RLF     COLMASK, F
00E3   2???           00306     GOTO    SCAN_COL_LOOP
00E4   30FF           00307     MOVLW   0xFF            ; No se detectó tecla
00E5   00A2           00308     MOVWF   INDICE
00E6   0008           00309     RETURN
00E7                  00310 TECLAS:
00E7   0782           00311     ADDWF   PCL, F
00E8   34FF           00312     RETLW   0xFF    ; 0: * (fila 1, col 1)
00E9   3400           00313     RETLW   0x00    ; 1: 0 (fila 1, col 2)
00EA   34FF           00314     RETLW   0xFF    ; 2: # (fila 1, col 3)
00EB   3407           00315     RETLW   0x07    ; 3: 7 (fila 2, col 1)
00EC   3408           00316     RETLW   0x08    ; 4: 8 (fila 2, col 2)
00ED   3409           00317     RETLW   0x09    ; 5: 9 (fila 2, col 3)
00EE   3404           00318     RETLW   0x04    ; 6: 4 (fila 3, col 1)
00EF   3405           00319     RETLW   0x05    ; 7: 5 (fila 3, col 2)
00F0   3406           00320     RETLW   0x06    ; 8: 6 (fila 3, col 3)
00F1   3401           00321     RETLW   0x01    ; 9: 1 (fila 4, col 1)
00F2   3402           00322     RETLW   0x02    ; 10: 2 (fila 4, col 2)
00F3   3403           00323     RETLW   0x03    ; 11: 3 (fila 4, col 3)
                      00324     ; Eliminado el índice 12, ya que solo hay 12 teclas en 4x3
                      00325 
                      00326 ;----------------------------------------------------------
                      00327 ;Subrutina del display
                      00328 ;------------------------------------------------------------------------
00F4                  00329 ACTUALIZAR_DISPLAY:
00F4   0830           00330     MOVF    TEMPACTUAL, W ; o TEMPREF
00F5   00AB           00331     MOVWF   WREG_TEMP
00F6   300A           00332     MOVLW   .10
00F7   00AC           00333     MOVWF   WREG_TEMP2
00F8   01A6           00334     CLRF    DIGITO_1
00F9                  00335 BUCLE_RESTA:
00F9   022B           00336     SUBWF   WREG_TEMP, W
00FA   1C03           00337     BTFSS   STATUS, C
00FB   2???           00338     GOTO    GUARDAR_UNIDAD
00FC   0AA6           00339     INCF    DIGITO_1, F
00FD   082B           00340     MOVF    WREG_TEMP, W
00FE   022C           00341     SUBWF   WREG_TEMP2, W
00FF   00AB           00342     MOVWF   WREG_TEMP
0100   2???           00343     GOTO    BUCLE_RESTA
0101                  00344 GUARDAR_UNIDAD:
MPASM 5.87                        CODIGO.ASM   6-15-2025  20:57:51         PAGE  8


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0101   082B           00345     MOVF    WREG_TEMP, W
0102   00A5           00346     MOVWF   DIGITO_0
0103   0008           00347     RETURN
                      00348 ; --------------------------------------------
0104                  00349 RETARDO_20ms:           ; Rutina de retardo aproximado de 20 ms usando bucles anidados.
0104   300A           00350     MOVLW       .10
0105   00A8           00351     MOVWF       CONT0
0106   30FA           00352 L2  MOVLW       .250
0107   00A9           00353     MOVWF       CONT1
0108   0000           00354 L1  NOP             
0109   0BA9           00355     DECFSZ      CONT1, 1
010A   2???           00356     GOTO        L1
010B   0BA8           00357     DECFSZ      CONT0,1
010C   2???           00358     GOTO        L2
010D   0008           00359     RETURN
                      00360 ;-----------------------------------------------------------------------------
010E                  00361 TABLA_7SEG:
010E   34C0           00362     RETLW   B'11000000' ; 0
010F   34F9           00363     RETLW   B'11111001' ; 1
0110   34A4           00364     RETLW   B'10100100' ; 2
0111   34B0           00365     RETLW   B'10110000' ; 3
0112   3499           00366     RETLW   B'10011001' ; 4
0113   3492           00367     RETLW   B'10010010' ; 5
0114   3482           00368     RETLW   B'10000010' ; 6
0115   34F8           00369     RETLW   B'11111000' ; 7
0116   3480           00370     RETLW   B'10000000' ; 8
0117   3490           00371     RETLW   B'10010000' ; 9
                      00372 ; --------------------------------------------
0118                  00373 ISR:                    ; Rutina principal de atención a interrupciones: verifica la fuente y salta a l
                            a rutina correspondiente.
0118   00F0           00374     MOVWF   WTEMP       ;Guardo el contexto previo a la interrupcion
0119   0E03           00375     SWAPF   STATUS,W
011A   00F1           00376     MOVWF   STATUST
011B   190B           00377     BTFSC   INTCON, T0IF  ;Testeo del Timer0
011C   2???           00378     GOTO    ISR_TMR0   
011D   1283 1303      00379     BANKSEL PIR1        ; Testeo de banderas
011F   188B           00380     BTFSC   INTCON,INTF ; Bandera del Pulsador
0120   2???           00381     GOTO    ISR_RB0
0121   180C           00382     BTFSC   PIR1,TMR1IF  ; Bandera del TMR1
0122   2???           00383     GOTO    ISR_TMR1
0123   1B0C           00384     BTFSC   PIR1,ADIF   ; Bandera del ADC
0124   2???           00385     GOTO    ISR_ADC
0125   1A0C           00386     BTFSC   PIR1,TXIF   ;Bandera de Tx
0126   2???           00387     GOTO    ISR_TRANSMICION 
0127   2???           00388     GOTO    SALIR
                      00389 ; --------------------------------------------
0128                  00390 ISR_TMR0:
0128   110B           00391     BCF     INTCON, T0IF
0129   1005           00392     BCF     PORTA, 0
012A   1085           00393     BCF     PORTA, 1
012B   0827           00394     MOVF    DISPLAY_FLAG, W
012C   1903           00395     BTFSC   STATUS, Z
012D   2???           00396     GOTO    MUX_DISPLAY_1
MPASM 5.87                        CODIGO.ASM   6-15-2025  20:57:51         PAGE  9


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00397     ; Mostrar unidad
012E   0825           00398     MOVF    DIGITO_0, W
012F   2???           00399     CALL    TABLA_7SEG
0130   0087           00400     MOVWF   PORTC
0131   1485           00401     BSF     PORTA, 1
0132   01A7           00402     CLRF    DISPLAY_FLAG
0133   2???           00403     GOTO    SALIR
0134                  00404 MUX_DISPLAY_1:
0134   0826           00405     MOVF    DIGITO_1, W
0135   2???           00406     CALL    TABLA_7SEG
0136   0087           00407     MOVWF   PORTC
0137   1405           00408     BSF     PORTA, 0
0138   3001           00409     MOVLW   0x01
0139   00A7           00410     MOVWF   DISPLAY_FLAG
013A   2???           00411     GOTO    SALIR
                      00412 ;----------------------------------------------
013B                  00413 ISR_RB0     ; Atiende la interrupción por el pulsador en RB0 y conmuta la bandera de ingreso.
013B   108B           00414     BCF     INTCON,INTF
013C   1283 1303      00415     BANKSEL INGRESAR
013E   3001           00416     MOVLW   .1
013F   06A0           00417     XORWF   INGRESAR,F   ;si estaba en 1 pasa a 0, si estaba en 0 pasa a 1
0140   2???           00418     GOTO    SALIR
                      00419 ; --------------------------------------------
0141                  00420 ISR_TMR1:   ; Atiende la interrupción del temporizador 1 y activa la bandera de 1 segundo.
0141   100C           00421     BCF     PIR1,TMR1IF
0142   142D           00422     BSF     FLAG_1SEG,0
0143   2???           00423     GOTO    SALIR
                      00424 ; --------------------------------------------
0144                  00425 ISR_ADC:    ; Atiende la interrupción del ADC y limpia la bandera correspondiente.
0144   130C           00426     BCF     PIR1,ADIF
0145   1283 1303      00427     BANKSEL ADRESH
0147   081E           00428     MOVF    ADRESH, W           ; Leemos solo ADRESH (justificado a la izquierda)
0148   00B0           00429     MOVWF   TEMPACTUAL          ; Guardamos la temperatura
0149   2???           00430     CALL    ACTUALIZAR_DISPLAY  ; Cada vez que se complete una conversion del ADC se actualizan los disp
                            lays *(REVISAR POR LAS DUDAS)*
014A   142E           00431     BSF     FLAG_ADC_OK, 0
014B   2???           00432     GOTO    SALIR
                      00433 ; --------------------------------------------
014C                  00434 ISR_TRANSMICION:    ; Atiende la interrupción de transmisión y limpia la bandera correspondiente.
014C   120C           00435     BCF     PIR1,TXIF
014D   102F           00436     BCF     FLAG_TX, 0
014E   2???           00437     GOTO    SALIR
                      00438 ; --------------------------------------------
014F                  00439 SALIR:    ; Restaura el contexto y retorna de la interrupción.
014F   0E71           00440     SWAPF   STATUST,W
0150   00F1           00441     MOVWF   STATUST
0151   0EF0           00442     SWAPF   WTEMP,F
0152   0E70           00443     SWAPF   WTEMP,W
0153   0009           00444     RETFIE
                      00445 ; --------------------------------------------
                      00446     END
MPASM 5.87                        CODIGO.ASM   6-15-2025  20:57:51         PAGE 10


SYMBOL TABLE
  LABEL                             VALUE 

ABDEN                             00000000
ABDOVF                            00000007
ACKDT                             00000005
ACKEN                             00000004
ACKSTAT                           00000006
ACTUALIZAR_DISPLAY                000000F4
ADCON0                            0000001F
ADCON1                            0000009F
ADCS0                             00000006
ADCS1                             00000007
ADDEN                             00000003
ADFM                              00000007
ADIE                              00000006
ADIF                              00000006
ADON                              00000000
ADRESH                            0000001E
ADRESL                            0000009E
ANS0                              00000000
ANS1                              00000001
ANS10                             00000002
ANS11                             00000003
ANS12                             00000004
ANS13                             00000005
ANS2                              00000002
ANS3                              00000003
ANS4                              00000004
ANS5                              00000005
ANS6                              00000006
ANS7                              00000007
ANS8                              00000000
ANS9                              00000001
ANSEL                             00000188
ANSELH                            00000189
BAUDCTL                           00000187
BCLIE                             00000003
BCLIF                             00000003
BF                                00000000
BRG0                              00000000
BRG1                              00000001
BRG10                             00000002
BRG11                             00000003
BRG12                             00000004
BRG13                             00000005
BRG14                             00000006
BRG15                             00000007
BRG16                             00000003
BRG2                              00000002
BRG3                              00000003
BRG4                              00000004
BRG5                              00000005
BRG6                              00000006
BRG7                              00000007
BRG8                              00000000
MPASM 5.87                        CODIGO.ASM   6-15-2025  20:57:51         PAGE 11


SYMBOL TABLE
  LABEL                             VALUE 

BRG9                              00000001
BRGH                              00000002
BUCLE_RESTA                       000000F9
C                                 00000000
C1CH0                             00000000
C1CH1                             00000001
C1IE                              00000005
C1IF                              00000005
C1OE                              00000005
C1ON                              00000007
C1OUT                             00000006
C1POL                             00000004
C1R                               00000002
C1RSEL                            00000005
C1SEN                             00000005
C2CH0                             00000000
C2CH1                             00000001
C2IE                              00000006
C2IF                              00000006
C2OE                              00000005
C2ON                              00000007
C2OUT                             00000006
C2POL                             00000004
C2R                               00000002
C2REN                             00000004
C2RSEL                            00000004
C2SYNC                            00000000
CCP1CON                           00000017
CCP1IE                            00000002
CCP1IF                            00000002
CCP1M0                            00000000
CCP1M1                            00000001
CCP1M2                            00000002
CCP1M3                            00000003
CCP1X                             00000005
CCP1Y                             00000004
CCP2CON                           0000001D
CCP2IE                            00000000
CCP2IF                            00000000
CCP2M0                            00000000
CCP2M1                            00000001
CCP2M2                            00000002
CCP2M3                            00000003
CCP2X                             00000005
CCP2Y                             00000004
CCPR1                             00000015
CCPR1H                            00000016
CCPR1L                            00000015
CCPR2                             0000001B
CCPR2H                            0000001C
CCPR2L                            0000001B
CHS0                              00000002
CHS1                              00000003
MPASM 5.87                        CODIGO.ASM   6-15-2025  20:57:51         PAGE 12


SYMBOL TABLE
  LABEL                             VALUE 

CHS2                              00000004
CHS3                              00000005
CKE                               00000006
CKP                               00000004
CM1CON0                           00000107
CM2CON0                           00000108
CM2CON1                           00000109
COL                               00000023
COLMASK                           00000024
CONT0                             00000028
CONT1                             00000029
CREN                              00000004
CSRC                              00000007
D                                 00000005
DATA_ADDRESS                      00000005
DC                                00000001
DC1B0                             00000004
DC1B1                             00000005
DC2B0                             00000004
DC2B1                             00000005
DIG1                              0000002A
DIGITO_0                          00000025
DIGITO_1                          00000026
DISPLAY_FLAG                      00000027
DIV_LOOP                          0000006D
D_A                               00000005
D_NOT_A                           00000005
ECCPAS                            0000009C
ECCPAS0                           00000004
ECCPAS1                           00000005
ECCPAS2                           00000006
ECCPASE                           00000007
EEADR                             0000010D
EEADRH                            0000010F
EECON1                            0000018C
EECON2                            0000018D
EEDAT                             0000010C
EEDATA                            0000010C
EEDATH                            0000010E
EEIE                              00000004
EEIF                              00000004
EEPGD                             00000007
ENVIAR_DIGITOS                    00000074
ENVIAR_UART                       00000068
ESCANEAR_TECLAS                   000000B5
ESPERO_TX1                        00000077
ESPERO_TX2                        0000007C
ESPERO_TX3                        00000080
F                                 00000001
FERR                              00000002
FLAG_1SEG                         0000002D
FLAG_ADC_OK                       0000002E
FLAG_TX                           0000002F
MPASM 5.87                        CODIGO.ASM   6-15-2025  20:57:51         PAGE 13


SYMBOL TABLE
  LABEL                             VALUE 

FOUND_ROW                         000000D6
FSR                               00000004
FVREN                             00000000
GCEN                              00000007
GIE                               00000007
GO                                00000001
GO_DONE                           00000001
GO_NOT_DONE                       00000001
GUARDAR_UNIDAD                    00000101
HTS                               00000002
I2C_DATA                          00000005
I2C_READ                          00000002
I2C_START                         00000003
I2C_STOP                          00000004
INDF                              00000000
INDICE                            00000022
INGRESAR                          00000020
INICIAR_ADC                       0000005F
INTCON                            0000000B
INTE                              00000004
INTEDG                            00000006
INTF                              00000001
IOCB                              00000096
IOCB0                             00000000
IOCB1                             00000001
IOCB2                             00000002
IOCB3                             00000003
IOCB4                             00000004
IOCB5                             00000005
IOCB6                             00000006
IOCB7                             00000007
IRCF0                             00000004
IRCF1                             00000005
IRCF2                             00000006
IRP                               00000007
ISR                               00000118
ISR_ADC                           00000144
ISR_RB0                           0000013B
ISR_TMR0                          00000128
ISR_TMR1                          00000141
ISR_TRANSMICION                   0000014C
L1                                00000108
L2                                00000106
LTS                               00000001
MAIN                              00000005
MAIN_LOOP                         0000004E
MC1OUT                            00000007
MC2OUT                            00000006
MSK                               00000093
MSK0                              00000000
MSK1                              00000001
MSK2                              00000002
MSK3                              00000003
MPASM 5.87                        CODIGO.ASM   6-15-2025  20:57:51         PAGE 14


SYMBOL TABLE
  LABEL                             VALUE 

MSK4                              00000004
MSK5                              00000005
MSK6                              00000006
MSK7                              00000007
MUX_DISPLAY_1                     00000134
NEXT_COL                          000000DE
NOT_A                             00000005
NOT_ADDRESS                       00000005
NOT_BO                            00000000
NOT_BOR                           00000000
NOT_DONE                          00000001
NOT_PD                            00000003
NOT_POR                           00000001
NOT_RBPU                          00000007
NOT_RC8                           00000006
NOT_T1SYNC                        00000002
NOT_TO                            00000004
NOT_TX8                           00000006
NOT_W                             00000002
NOT_WRITE                         00000002
OERR                              00000001
OPTION_REG                        00000081
OSCCON                            0000008F
OSCTUNE                           00000090
OSFIE                             00000007
OSFIF                             00000007
OSTS                              00000003
P                                 00000004
P1M0                              00000006
P1M1                              00000007
PCL                               00000002
PCLATH                            0000000A
PCON                              0000008E
PDC0                              00000000
PDC1                              00000001
PDC2                              00000002
PDC3                              00000003
PDC4                              00000004
PDC5                              00000005
PDC6                              00000006
PEIE                              00000006
PEN                               00000002
PIE1                              0000008C
PIE2                              0000008D
PIR1                              0000000C
PIR2                              0000000D
PORTA                             00000005
PORTB                             00000006
PORTC                             00000007
PORTD                             00000008
PORTE                             00000009
PR2                               00000092
PREPARAR_TX                       00000065
MPASM 5.87                        CODIGO.ASM   6-15-2025  20:57:51         PAGE 15


SYMBOL TABLE
  LABEL                             VALUE 

PRSEN                             00000007
PS0                               00000000
PS1                               00000001
PS2                               00000002
PSA                               00000003
PSSAC0                            00000002
PSSAC1                            00000003
PSSBD0                            00000000
PSSBD1                            00000001
PSTRCON                           0000009D
PULSR                             00000002
PULSS                             00000003
PWM1CON                           0000009B
R                                 00000002
RA0                               00000000
RA1                               00000001
RA2                               00000002
RA3                               00000003
RA4                               00000004
RA5                               00000005
RA6                               00000006
RA7                               00000007
RB0                               00000000
RB1                               00000001
RB2                               00000002
RB3                               00000003
RB4                               00000004
RB5                               00000005
RB6                               00000006
RB7                               00000007
RBIE                              00000003
RBIF                              00000000
RC0                               00000000
RC1                               00000001
RC2                               00000002
RC3                               00000003
RC4                               00000004
RC5                               00000005
RC6                               00000006
RC7                               00000007
RC8_9                             00000006
RC9                               00000006
RCD8                              00000000
RCEN                              00000003
RCIDL                             00000006
RCIE                              00000005
RCIF                              00000005
RCREG                             0000001A
RCSTA                             00000018
RD                                00000000
RD0                               00000000
RD1                               00000001
RD2                               00000002
MPASM 5.87                        CODIGO.ASM   6-15-2025  20:57:51         PAGE 16


SYMBOL TABLE
  LABEL                             VALUE 

RD3                               00000003
RD4                               00000004
RD5                               00000005
RD6                               00000006
RD7                               00000007
RE0                               00000000
RE1                               00000001
RE2                               00000002
RE3                               00000003
READ_WRITE                        00000002
RETARDO_20ms                      00000104
RP0                               00000005
RP1                               00000006
RSEN                              00000001
RX9                               00000006
RX9D                              00000000
R_NOT_W                           00000002
R_W                               00000002
S                                 00000003
SALIR                             0000014F
SBOREN                            00000004
SCAN_COL_LOOP                     000000B8
SCAN_ROW_LOOP                     000000CC
SCKP                              00000004
SCS                               00000000
SEN                               00000000
SENDB                             00000003
SMP                               00000007
SPBRG                             00000099
SPBRGH                            0000009A
SPEN                              00000007
SR0                               00000006
SR1                               00000007
SRCON                             00000185
SREN                              00000005
SSPADD                            00000093
SSPBUF                            00000013
SSPCON                            00000014
SSPCON2                           00000091
SSPEN                             00000005
SSPIE                             00000003
SSPIF                             00000003
SSPM0                             00000000
SSPM1                             00000001
SSPM2                             00000002
SSPM3                             00000003
SSPMSK                            00000093
SSPOV                             00000006
SSPSTAT                           00000094
STATUS                            00000003
STATUST                           00000071
STRA                              00000000
STRB                              00000001
MPASM 5.87                        CODIGO.ASM   6-15-2025  20:57:51         PAGE 17


SYMBOL TABLE
  LABEL                             VALUE 

STRC                              00000002
STRD                              00000003
STRSYNC                           00000004
SWDTEN                            00000000
SYNC                              00000004
T0CS                              00000005
T0IE                              00000005
T0IF                              00000002
T0SE                              00000004
T1CKPS0                           00000004
T1CKPS1                           00000005
T1CON                             00000010
T1GINV                            00000007
T1GIV                             00000007
T1GSS                             00000001
T1INSYNC                          00000002
T1OSCEN                           00000003
T1SYNC                            00000002
T2CKPS0                           00000000
T2CKPS1                           00000001
T2CON                             00000012
TABLA_7SEG                        0000010E
TECLADO                           00000084
TECLADO_PRIMER_DIGITO             000000B1
TECLADO_SEGUNDO_DIGITO            000000A1
TECLAS                            000000E7
TEMPACTUAL                        00000030
TEMPREF                           00000021
TMR0                              00000001
TMR0IE                            00000005
TMR0IF                            00000002
TMR1                              0000000E
TMR1CS                            00000001
TMR1GE                            00000006
TMR1H                             0000000F
TMR1IE                            00000000
TMR1IF                            00000000
TMR1L                             0000000E
TMR1ON                            00000000
TMR2                              00000011
TMR2IE                            00000001
TMR2IF                            00000001
TMR2ON                            00000002
TOUTPS0                           00000003
TOUTPS1                           00000004
TOUTPS2                           00000005
TOUTPS3                           00000006
TRISA                             00000085
TRISA0                            00000000
TRISA1                            00000001
TRISA2                            00000002
TRISA3                            00000003
TRISA4                            00000004
MPASM 5.87                        CODIGO.ASM   6-15-2025  20:57:51         PAGE 18


SYMBOL TABLE
  LABEL                             VALUE 

TRISA5                            00000005
TRISA6                            00000006
TRISA7                            00000007
TRISB                             00000086
TRISB0                            00000000
TRISB1                            00000001
TRISB2                            00000002
TRISB3                            00000003
TRISB4                            00000004
TRISB5                            00000005
TRISB6                            00000006
TRISB7                            00000007
TRISC                             00000087
TRISC0                            00000000
TRISC1                            00000001
TRISC2                            00000002
TRISC3                            00000003
TRISC4                            00000004
TRISC5                            00000005
TRISC6                            00000006
TRISC7                            00000007
TRISD                             00000088
TRISD0                            00000000
TRISD1                            00000001
TRISD2                            00000002
TRISD3                            00000003
TRISD4                            00000004
TRISD5                            00000005
TRISD6                            00000006
TRISD7                            00000007
TRISE                             00000089
TRISE0                            00000000
TRISE1                            00000001
TRISE2                            00000002
TRISE3                            00000003
TRMT                              00000001
TUN0                              00000000
TUN1                              00000001
TUN2                              00000002
TUN3                              00000003
TUN4                              00000004
TX8_9                             00000006
TX9                               00000006
TX9D                              00000000
TXD8                              00000000
TXEN                              00000005
TXIE                              00000004
TXIF                              00000004
TXREG                             00000019
TXSTA                             00000098
UA                                00000001
ULPWUE                            00000005
ULPWUIE                           00000002
MPASM 5.87                        CODIGO.ASM   6-15-2025  20:57:51         PAGE 19


SYMBOL TABLE
  LABEL                             VALUE 

ULPWUIF                           00000002
VCFG0                             00000004
VCFG1                             00000005
VR0                               00000000
VR1                               00000001
VR2                               00000002
VR3                               00000003
VRCON                             00000097
VREN                              00000007
VROE                              00000006
VRR                               00000005
VRSS                              00000004
W                                 00000000
WCOL                              00000007
WDTCON                            00000105
WDTPS0                            00000001
WDTPS1                            00000002
WDTPS2                            00000003
WDTPS3                            00000004
WPUB                              00000095
WPUB0                             00000000
WPUB1                             00000001
WPUB2                             00000002
WPUB3                             00000003
WPUB4                             00000004
WPUB5                             00000005
WPUB6                             00000006
WPUB7                             00000007
WR                                00000001
WREG_TEMP                         0000002B
WREG_TEMP2                        0000002C
WREN                              00000002
WRERR                             00000003
WTEMP                             00000070
WUE                               00000001
Z                                 00000002
_BOR21V                           00003EFF
_BOR40V                           00003FFF
_BOR4V_BOR21V                     00003EFF
_BOR4V_BOR40V                     00003FFF
_BOREN_NSLEEP                     00003EFF
_BOREN_OFF                        00003CFF
_BOREN_ON                         00003FFF
_BOREN_SBODEN                     00003DFF
_BOR_NSLEEP                       00003EFF
_BOR_OFF                          00003CFF
_BOR_ON                           00003FFF
_BOR_SBODEN                       00003DFF
_CONFIG1                          00002007
_CONFIG2                          00002008
_CPD_OFF                          00003FFF
_CPD_ON                           00003F7F
_CP_OFF                           00003FFF
MPASM 5.87                        CODIGO.ASM   6-15-2025  20:57:51         PAGE 20


SYMBOL TABLE
  LABEL                             VALUE 

_CP_ON                            00003FBF
_DEBUG_OFF                        00003FFF
_DEBUG_ON                         00001FFF
_DEVID1                           00002006
_EC_OSC                           00003FFB
_EXTRC                            00003FFF
_EXTRCIO                          00003FFE
_EXTRC_OSC_CLKOUT                 00003FFF
_EXTRC_OSC_NOCLKOUT               00003FFE
_FCMEN_OFF                        000037FF
_FCMEN_ON                         00003FFF
_FOSC_EC                          00003FFB
_FOSC_EXTRC_CLKOUT                00003FFF
_FOSC_EXTRC_NOCLKOUT              00003FFE
_FOSC_HS                          00003FFA
_FOSC_INTRC_CLKOUT                00003FFD
_FOSC_INTRC_NOCLKOUT              00003FFC
_FOSC_LP                          00003FF8
_FOSC_XT                          00003FF9
_HS_OSC                           00003FFA
_IDLOC0                           00002000
_IDLOC1                           00002001
_IDLOC2                           00002002
_IDLOC3                           00002003
_IESO_OFF                         00003BFF
_IESO_ON                          00003FFF
_INTOSC                           00003FFD
_INTOSCIO                         00003FFC
_INTRC_OSC_CLKOUT                 00003FFD
_INTRC_OSC_NOCLKOUT               00003FFC
_LP_OSC                           00003FF8
_LVP_OFF                          00002FFF
_LVP_ON                           00003FFF
_MCLRE_OFF                        00003FDF
_MCLRE_ON                         00003FFF
_PWRTE_OFF                        00003FFF
_PWRTE_ON                         00003FEF
_WDTE_OFF                         00003FF7
_WDTE_ON                          00003FFF
_WDT_OFF                          00003FF7
_WDT_ON                           00003FFF
_WRT_1FOURTH                      00003BFF
_WRT_256                          00003DFF
_WRT_HALF                         000039FF
_WRT_OFF                          00003FFF
_XT_OSC                           00003FF9
__16F887                          00000001

Errors   :     0
Warnings :     0 reported,     0 suppressed
Messages :    13 reported,     0 suppressed

